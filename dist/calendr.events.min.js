/*
 * calendr - v0.0.3
 * 2014-07-30
 * License: MIT
 */
!function(a){function b(a,b){var d=[];return d=b.repeats in o?o[b.repeats](a,b):c("month",a,b.startson)?[]:[b.startson.date()]}function c(a,b,c,d){switch(d=p[d]||p["==="],a){case"month":return!(c&&d(b.moment.year(),c.year())&&d(b.moment.month(),c.month()));case"month!":return!(c&&d(b.moment.month(),c.month()));case"year":return!(c&&d(b.moment.year(),c.year()))}}function d(a,b){var c=1e5,d=parseInt(new Date(a.startson).getTime()/c,10),e=parseInt(new Date(b.startson).getTime()/c,10);return d===e?a.name>b.name?1:a.name<b.name?-1:0:d-e}function e(a){return n.indexOf(a.toLowerCase())}function f(a,b){var d,e=[],f=a.moment,g=f.daysInMonth(),h=b.startson,i=b.repeatEndson,j=f.month(),k=h.month(),m=h.date(),n=j>k?1:m;if(b.repeatTimes){if(d=n+b.repeatTimes-1,j>k&&d+m<=h.daysInMonth())return[];if(d>g){for(var o=f.year();j>k;){var p=l([o,j-1,1]).daysInMonth();d-=p-1,j--}d>g&&(d=g),d++}}else d=c("month",a,i)?g+1:i.date();for(;d>=n;n++)e.push(n);return e}function g(a,b){var d,f=[],g=a.grid().length,h=a.moment,i=b.startson,m=b.repeatEndson,n=h.month(),o=i.month(),p=j(i),q=n>o?0:p;if(b.repeatTimes){if(d=p+b.repeatTimes-1,n>o&&d<k(i))return[];if(d>g){for(var r=h.year();n>o;){var s=l([r,n,1]);d-=k(s)-1,n--}d>g&&(d=g),d--}}else d=c("month",a,m)?g-1:j(m);for(var t=b.repeatsOn.map(e),u=t.length;d>=q;q++)for(var v=0;u>v;v++){var w=t[v]-a.i;q>0&&(w+=7*q),0>w||(w++,!c("month!",a,i)&&w<i.date()||(c("year",a,m)||!(!c("month!",a,m)&&w>m.date()||!c("month!",a,m,">")))&&f.push(w))}return f}function h(a,b){var d=[],e=a.moment,f=b.startson,g=b.repeatEndson;if(b.repeatTimes){var h=f.month()+b.repeatTimes;e.month()<h&&(d=[f.date()])}else(!g||!c("month!",a,f)||!c("month!",a,g,"<")||!c("month!",a,g)&&g.date()>=f.date())&&(d=[f.date()]);return d}function i(a,b){var d=[],e=a.moment,f=b.startson,g=b.repeatEndson;if(c("month!",a,f))return d;if(b.repeatTimes){var h=f.year()+b.repeatTimes;e.year()<h&&(d=[f.date()])}else(!g||e.year()<=g.year()&&!c("month!",a,g)&&g.date()>=f.date())&&(d=[f.date()]);return d}function j(a){var b=l([a.year(),a.month(),1]);return Math.floor((a.date()-1+b.day())/7)}function k(a){var b=l([a.year(),a.month(),1]);return Math.ceil((b.day()+b.daysInMonth())/7)}var l,m;if(a){if(!("moment"in a))throw new Error("moment.js is required");if(!("Calendr"in a))throw new Error("calendr.js is required");l=a.moment,m=a.Calendr}else l=require("moment"),m=require("..");var n=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];m.prototype.events=function(a){if(!this.dayObjects){var e="Calendr must be set with dayObjects = true to use the `events` method";throw new Error(e)}if(a=a||[],0!==a.length){"undefined"==typeof this._grid&&this.grid(),a.sort(d);for(var f=this,g=this.moment.daysInMonth(),h=0,i=a.length;i>h;h++){var j=[],k=a[h];if(k.startson=l(k.startson),k.repeatEndson=k.repeatEndson&&l(k.repeatEndson),!c("month",f,k.startson,">=")){j=b(f,k);for(var m=0,n=j.length;n>m;m++){var o=j[m];if(!(o>g)){var p=f.getDay(o);p&&p.events.push(k)}}}}}};var o={daily:f,weekly:g,monthly:h,yearly:i},p={"===":function(a,b){return a===b},">=":function(a,b){return a>=b},">":function(a,b){return a>b},"<":function(a,b){return b>a}}}("undefined"==typeof module&&"undefined"==typeof exports?window:null);